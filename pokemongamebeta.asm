.data
	.include "./sprites/animations/TallGrassAnimated1.data"
	.include "./sprites/animations/TallGrassAnimated2.data"
	.include "./sprites/animations/TallGrassAnimated3.data"
	.include "./sprites/animations/TallGrassAnimated4.data"
	.include "./sprites/decorations/pokeball_red.data"
	.include "./sprites/decorations/mesa.data"
	.include "./sprites/people/oak_n1.data"
	.include "./sprites/people/oak_n2.data"
	.include "./sprites/people/oak_n3.data"
	.include "./sprites/people/oak_s1.data"
	.include "./sprites/people/oak_s2.data"
	.include "./sprites/people/oak_s3.data"
	.include "./sprites/people/oak_e1.data"
	.include "./sprites/people/oak_e2.data"
	.include "./sprites/people/oak_e3.data"
	.include "./sprites/people/hero_n1.data"
	.include "./sprites/people/hero_n2.data"
	.include "./sprites/people/hero_s1.data"
	.include "./sprites/people/hero_s2.data"
	.include "./sprites/people/hero_e1.data"
	.include "./sprites/people/hero_e2.data"
	.include "./sprites/people/hero_e3.data"
	.include "./sprites/people/run_n1.data"
	.include "./sprites/people/run_n2.data"
	.include "./sprites/people/run_s1.data"
	.include "./sprites/people/run_s2.data"
	.include "./sprites/people/run_e1.data"
	.include "./sprites/people/run_e2.data"
	.include "./sprites/people/run_e3.data"
	.include "./sprites/tiles/tile_labwall.data"
	.include "./sprites/tiles/tile_labfloor.data"
	.include "./sprites/tiles/tile_darkfloor.data"
	.include "./sprites/tiles/tile_flower.data"
	.include "./sprites/tiles/tile_treetop.data"
	.include "./sprites/tiles/tile_treemid.data"
	.include "./sprites/tiles/tile_treetrunk.data"
	.include "./sprites/tiles/tile_treetop2.data"
	.include "./sprites/tiles/tile_treemid2.data"
	.include "./sprites/tiles/tile_tallgrass.data"
	.include "./sprites/tiles/tile_grass1.data"
	.include "./sprites/tiles/tile_grass2.data"
	.include "./sprites/tiles/tile_grass3.data"
	.include "./sprites/tiles/tile_grass4.data"
	.include "./sprites/tiles/tile_yellowledgeleft.data"
	.include "./sprites/tiles/tile_yellowledgemiddle.data"
	.include "./sprites/tiles/tile_greenledgeleft.data"
	.include "./sprites/tiles/tile_greenledgemiddle.data"
	.include "./sprites/tiles/tile_plaque.data"
	.include "./sprites/tiles/tile_fencehor.data"
	.include "./sprites/tiles/tile_fenceL.data"
	.include "./sprites/tiles/tile_yellow1.data"
	.include "./sprites/tiles/tile_yellow2.data"
	.include "./sprites/tiles/tile_yellow3.data"
	.include "./sprites/tiles/tile_yellow4.data"
	.include "./sprites/tiles/tile_yellow5.data"
	.include "./sprites/tiles/tile_yellow6.data"
	.include "./sprites/tiles/tile_yellow7.data"
	.include "./sprites/tiles/tile_yellow8.data"
	.include "./sprites/tiles/tile_m1.data"
	.include "./sprites/tiles/tile_m2.data"
	.include "./sprites/tiles/tile_m5.data"
	.include "./sprites/tiles/tile_battleMSG1.data"
	.include "./sprites/tiles/tile_battleMSG2.data"
	.include "./sprites/tiles/tile_battleMSG3.data"
	.include "./sprites/tiles/exit_carpet.data"
	.include "./sprites/tiles/lower_battle_circle.data"
	.include "./sprites/tiles/upper_battle_circle.data"
	.include "./sprites/pokemon/bulbasaur_front.data"
	.include "./sprites/pokemon/bulbasaur_back.data"
	.include "./sprites/pokemon/squirtle_front.data"
	.include "./sprites/pokemon/charmender_front.data"
	.include "./sprites/pokemon/eevee_front.data"
	.include "./sprites/pokemon/eevee_back.data"
	
BIG_ROUTE01: .word 40, 30,
.byte
14, 15, 14, 15, 14, 15, 14, 15, 14, 15, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43,	 14, 15, 14, 15, 14, 15, 14, 15, 14, 15, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43,
21, 22, 21, 22, 21, 22, 21, 22, 21, 22, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43,  21, 22, 21, 22, 21, 22, 21, 22, 21, 22, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43,
23, 24, 23, 24, 23, 24, 23, 24, 23, 24, 16, 16, 16, 16, 16, 16, 25, 27, 27, 26,  23, 24, 23, 24, 23, 24, 23, 24, 23, 24, 16, 16, 16, 16, 16, 16, 25, 27, 27, 26,
20, 28, 20, 28, 20, 18, 19, 18, 19, 18, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43,  20, 28, 20, 28, 20, 18, 19, 18, 19, 18, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43,
28, 19, 28, 20, 20, 17, 20, 17, 20, 17, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43,  28, 19, 28, 20, 20, 17, 20, 17, 20, 17, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43,
40, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 50, 42, 42, 43,  40, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 50, 42, 42, 43,
44, 45, 45, 45, 45, 45, 45, 45, 45, 46, 42, 42, 47, 45, 45, 45, 45, 45, 45, 49,  44, 45, 45, 45, 45, 45, 45, 45, 45, 46, 42, 42, 47, 45, 45, 45, 45, 45, 45, 49,
29, 31, 31, 30, 18, 19, 19, 32, 29, 25, 27, 27, 26, 31, 31, 31, 31, 31, 31, 30,  29, 31, 31, 30, 18, 19, 19, 32, 29, 25, 27, 27, 26, 31, 31, 31, 31, 31, 31, 30,
19, 18, 16, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43, 19, 18, 16, 16, 16, 16, 16,  19, 18, 16, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43, 19, 18, 16, 16, 16, 16, 16,
19, 17, 16, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43, 19, 17, 16, 16, 16, 16, 16,  19, 17, 16, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43, 19, 17, 16, 16, 16, 16, 16,
16, 16, 16, 16, 16, 16, 16, 18, 28, 44, 45, 45, 49, 16, 16, 16, 16, 16, 28, 19,  16, 16, 16, 16, 16, 16, 16, 18, 28, 44, 45, 45, 49, 16, 16, 16, 16, 16, 28, 19,
16, 16, 16, 16, 16, 16, 16, 28, 19, 18, 16, 16, 19, 16, 16, 16, 16, 16, 18, 28,  16, 16, 16, 16, 16, 16, 16, 28, 19, 18, 16, 16, 19, 16, 16, 16, 16, 16, 18, 28,
33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 16, 16, 35, 33, 33, 33, 33, 33, 33, 33,  33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 16, 16, 35, 33, 33, 33, 33, 33, 33, 33,
14, 15, 14, 15, 14, 15, 14, 15, 14, 36, 16, 16, 37, 15, 14, 15, 14, 15, 14, 15,  14, 15, 14, 15, 14, 15, 14, 15, 14, 36, 16, 16, 37, 15, 14, 15, 14, 15, 14, 15,
21, 22, 21, 22, 21, 22, 21, 22, 21, 38, 16, 16, 39, 22, 21, 22, 21, 22, 21, 22,  21, 22, 21, 22, 21, 22, 21, 22, 21, 38, 16, 16, 39, 22, 21, 22, 21, 22, 21, 22,

14, 15, 14, 15, 14, 15, 14, 15, 14, 15, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43,	 14, 15, 14, 15, 14, 15, 14, 15, 14, 15, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43,
21, 22, 21, 22, 21, 22, 21, 22, 21, 22, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43,  21, 22, 21, 22, 21, 22, 21, 22, 21, 22, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43,
23, 24, 23, 24, 23, 24, 23, 24, 23, 24, 16, 16, 16, 16, 16, 16, 25, 27, 27, 26,  23, 24, 23, 24, 23, 24, 23, 24, 23, 24, 16, 16, 16, 16, 16, 16, 25, 27, 27, 26,
20, 28, 20, 28, 20, 18, 19, 18, 19, 18, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43,  20, 28, 20, 28, 20, 18, 19, 18, 19, 18, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43,
28, 19, 28, 20, 20, 17, 20, 17, 20, 17, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43,  28, 19, 28, 20, 20, 17, 20, 17, 20, 17, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43,
40, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 50, 42, 42, 43,  40, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 50, 42, 42, 43,
44, 45, 45, 45, 45, 45, 45, 45, 45, 46, 42, 42, 47, 45, 45, 45, 45, 45, 45, 49,  44, 45, 45, 45, 45, 45, 45, 45, 45, 46, 42, 42, 47, 45, 45, 45, 45, 45, 45, 49,
29, 31, 31, 30, 18, 19, 19, 32, 29, 25, 27, 27, 26, 31, 31, 31, 31, 31, 31, 30,  29, 31, 31, 30, 18, 19, 19, 32, 29, 25, 27, 27, 26, 31, 31, 31, 31, 31, 31, 30,
19, 18, 16, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43, 19, 18, 16, 16, 16, 16, 16,  19, 18, 16, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43, 19, 18, 16, 16, 16, 16, 16,
19, 17, 16, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43, 19, 17, 16, 16, 16, 16, 16,  19, 17, 16, 16, 16, 16, 16, 16, 16, 48, 42, 42, 43, 19, 17, 16, 16, 16, 16, 16,
16, 16, 16, 16, 16, 16, 16, 18, 28, 44, 45, 45, 49, 16, 16, 16, 16, 16, 28, 19,  16, 16, 16, 16, 16, 16, 16, 18, 28, 44, 45, 45, 49, 16, 16, 16, 16, 16, 28, 19,
16, 16, 16, 16, 16, 16, 16, 28, 19, 18, 16, 16, 19, 16, 16, 16, 16, 16, 18, 28,  16, 16, 16, 16, 16, 16, 16, 28, 19, 18, 16, 16, 19, 16, 16, 16, 16, 16, 18, 28,
33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 16, 16, 35, 33, 33, 33, 33, 33, 33, 33,  33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 16, 16, 35, 33, 33, 33, 33, 33, 33, 33,
14, 15, 14, 15, 14, 15, 14, 15, 14, 36, 16, 16, 37, 15, 14, 15, 14, 15, 14, 15,  14, 15, 14, 15, 14, 15, 14, 15, 14, 36, 16, 16, 37, 15, 14, 15, 14, 15, 14, 15,
21, 22, 21, 22, 21, 22, 21, 22, 21, 38, 16, 16, 39, 22, 21, 22, 21, 22, 21, 22,  21, 22, 21, 22, 21, 22, 21, 22, 21, 38, 16, 16, 39, 22, 21, 22, 21, 22, 21, 22,


				
POSITION_MAP: .word 0,0

MOVEMENT: .byte 0

SETTING_ANIMATION: .byte 0

TIMER_ANIMATION: .word 0

POSITION_MAP_FR0: .word -1,-1

POSITION_MAP_FR1: .word -1,-1

.text

#########################################
# 					#
#					#
#	Não recebe nada como arg	#
#	e  não retorna nada		#
#					#
#########################################
	li	s11,0
GAME_LOOP:
	csrr	t6,time
	sub	t6,t6,s11
	li	t5,16
	ble	t6,t5,GAME_LOOP
	la	t0,MOVEMENT
	lb	t1,0(t0)
	bnez	t1,JUMP_KEY_POOL
	call	KEY_POOL				# chama a função keypool para ver se alguma das teclas a,s,d,w foram
	j	JUMP_MOVEMENT
JUMP_KEY_POOL:
	la	a0,MOVEMENT
	call 	MOVE
	la 	t0, POSITION_MAP			# carrego em t0 o endereço de posicao inicial p
	lw	t1, 0(t0)
	lw	t2, 4(t0)
	li	t3,16
	rem	t1,t1,t3
	rem	t2,t2,t3
	xor	t3,t1,t2
	bnez	t3,JUMP_MOVEMENT
	sb	zero,0(a0)
JUMP_MOVEMENT:
	xori 	s0, s0, 1				# inverte o valor frame atual (somente o registrador)
	call CHOOSE_MAP_FR
	mv	t3,a1
	la 	t0, POSITION_MAP			# carrego em t0 o endereço de posicao inicial p
	lw 	t1, 4(t0) 				# carrega em t1 a altura da posicao inicial p
	lw 	t2, 0(t0) 				# carrega em t2 a largura da posicao inicial p	
	la 	a0, BIG_ROUTE01				# a0 endereço do mapa que iremos utilizar para essa fase
	lw	t4, 4(t3)				# carrega em t4 a altura da posicao relativa ao frame que colocamos em t3
	lw	t5, 0(t3)				# carrega em t5 a largura da posicao relativa ao frame que colocamos em t3
	bne	t1, t4, JUMP_CHEKS_HEIGHT_WIDTH		# condição feita para printarmos os mapas somente quando a posicao muda
	bne	t2, t5, JUMP_CHEKS_HEIGHT_WIDTH		# condição feita para printarmos os mapas somente quando a posicao muda
	j	JUMP_PRINT_MAP				# como t1 == t4 e t2 == t5 não printamos o mapa e continuamos o fluxo
JUMP_CHEKS_HEIGHT_WIDTH:
	sw	t1, 4(t3)				# se t1 != t4 ou t2 != t5 salvamos em t3 que é o frame escolhido a altura 
	sw	t2, 0(t3)				# se t1 != t4 ou t2 != t5 salvamos em t3 que é o frame escolhido a largura 
	mv 	a4, s0					# movo para a4 o valor em s0 que é relativo ao frame da posicao t3
	call 	PRINT_MAP				# chamo a função print mapa com o frame em a4 como argumento essa função
							# imprime o mapa 640 x 480 no bitmap 320 x 240 lidando com os possiveis
							# valores quebrados das tiles onde devemos printar uma parte de cada uma
JUMP_PRINT_MAP:
	
	############################################################
	# a minha ideia é que a primeira coisa que devemos fazer é #
	# imprimir o mapa se ele tiver se movido do local anterior #
	############################################################
	
	call	ANIMATIONS
	
	li 	t0, 0xFF200604				# carrego em t0 o endereco de controle do frame mostrado no bitmap
	sw 	s0, 0(t0)				# coloco s0 no valor de controle da frame mostrada pelo bitmap
	
	csrr	s11,time
	
	j GAME_LOOP					# volta para o inicio do programa para fazer o loop principal do jogo	

.include "./PrintMap.asm"
.include "./DecideTile.asm"
.include "./KeyPool.asm"
.include "./ChooseMapFr.asm"
.include "./Move.asm"
.include "./Animations.asm"